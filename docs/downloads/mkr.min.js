/*!
 * VERSION: 0.1.2
 * DATE: 2017-03-02
 * UPDATES AND DOCS AT: https://chris-moody.github.io/mkr
 *
 * @license copyright 2017 Christopher C. Moody
 *
 *	Permission is hereby granted, free of charge, to any person obtaining a copy of
 *	this software and associated documentation files (the "Software"), to deal in the
 *	Software without restriction, including without limitation the rights to use, copy,
 *	modify, merge, publish, distribute, sublicense, and/or sell copies of the Software,
 *	and to permit persons to whom the Software is furnished to do so, subject to the
 *	following conditions:
 *
 *	The above copyright notice and this permission notice shall be included in all
 *	copies or substantial portions of the Software.
 *
 *	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
 *	INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
 *	PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 *	HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 *	OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 *	SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 * @author: Christopher C. Moody, chris@moodydigital.com
 */
!function(className,scope){var _instances={},_count=0,mkr=function(options){var id=_count;_count++,this._elements=[],this._states={},this._count=0,this._tag="mkr-"+id+"-index",options=options||{},options.tmln=options.tmln||{},this._tmln=new TimelineMax(options.tmln),delete options.tmln,this._imgDir=mkr.getDefault(options,"imgDir",""),delete options.imgDir;var parent=mkr.getDefault(options,"parent",document.body);delete options.parent,"string"==typeof parent&&(parent=mkr.query(parent)),this._preload=options.preload,delete options.preload,this._images=[],this._loadCallback=null,this._loadContext=null;var _loadedImages=0;mkr.setDefault(options,"attr",{});var classes="mkr-container mkr-"+id;"class"in options.attr?options.attr.class+=" "+classes:options.attr.class=classes,this.container=this.create("div",options,parent,!0),_instances[id]=this;var _imageLoaded=function(){_loadedImages++;var self=_instances[id];_loadedImages==self._images.length&&(self._loadCallback&&self._loadCallback.apply(self._loadContext),_preload=!1)};Object.defineProperty(this,"id",{get:function(){return id}}),this.load=function(callback,context){this._loadCallback=callback,this._loadContext=context;var i=this._images.length;if(i<=0)return void this._loadCallback.apply(this._loadContext);for(;i--;)this._images[i].img.onload=_imageLoaded;for(i=this._images.length;i--;)this._images[i].img.src=this._images[i].src}};mkr.makeDC=function(width,height,options){options=options||{},mkr.setDefault(options,"border",{}),mkr.setDefault(options.border,"css",{}),mkr.setDefault(options.border,"strokeWidth",1),mkr.setDefault(options.border.css,"width",width-2*options.border.strokeWidth),mkr.setDefault(options.border.css,"height",height-2*options.border.strokeWidth),mkr.setDefault(options.border.css,"top","0px"),mkr.setDefault(options.border.css,"left","0px"),mkr.setDefault(options.border.css,"zIndex",1e3),mkr.setDefault(options.border.css,"position","absolute"),mkr.setDefault(options.border.css,"pointerEvents","none"),mkr.setDefault(options.border.css,"borderWidth",options.border.strokeWidth+"px"),mkr.setDefault(options.border.css,"borderStyle","solid"),mkr.setDefault(options.border.css,"borderColor","#666666"),mkr.setDefault(options.border,"attr",{});var classes="mkr-border";"class"in options.border.attr?options.border.attr.class+=" "+classes:options.border.attr.class=classes;var border=document.createElement("div");TweenMax.set(border,options.border),delete options.border,mkr.setDefault(options,"attr",{}),mkr.setDefault(options,"css",{}),mkr.setDefault(options.css,"width",width),mkr.setDefault(options.css,"height",height),mkr.setDefault(options.css,"top","0px"),mkr.setDefault(options.css,"left","0px"),mkr.setDefault(options.css,"zIndex",1),mkr.setDefault(options.css,"overflow","hidden");var dc=new mkr(options);return dc.border=border,dc.container.appendChild(dc.border),dc},Object.defineProperty(mkr.prototype,"tmln",{get:function(){return this._tmln}}),Object.defineProperty(mkr.prototype,"width",{get:function(){return this.container.offsetWidth},set:function(value){this.container.offsetWidth=this.value}}),Object.defineProperty(mkr.prototype,"height",{get:function(){return this.container.offsetHeight},set:function(value){this.container.offsetHeight=this.value}}),mkr.prototype.create=function(type,options,parent,save){var t=type.toLowerCase();options=options||{},options.css=options.css||{},options.attr=options.attr||{};var element,xlnkns="http://www.w3.org/1999/xlink",svgns="http://www.w3.org/2000/svg",svgTags=["svg","defs","use","image","g","mask","clippath","lineargradient","radialgradient","stop","text","rect","circle","ellipse","line","polyline","polygon","path"];return svgTags.indexOf(t)>=0?(element=document.createElementNS(svgns,type),"svg"==type&&(options.css.position=options.css.position||"absolute"),"xlink:href"in options.attr&&(element.setAttributeNS(xlnkns,"href",options.attr["xlink:href"]),delete options.attr["xlink:href"])):(element=document.createElement(type),mkr.setDefault(options.css,"position","absolute"),mkr.setDefault(options,"force3d",!0)),"img"===type&&this._preload&&options.attr&&options.attr.src&&(this._images.push({img:element,src:options.attr.src}),delete options.attr.src),this.add(element,options,parent,save),element},mkr.prototype.batch=function(type,options,num,parent,save){for(var elements=[],n=num;n--;)elements.push(mkr.create(type,options,parent,save));return elements},mkr.prototype.add=function(target,options,parent,save){parent=null==parent||void 0===parent?this.container:parent,"string"==typeof parent&&(parent=mkr.query(parent)),save=void 0===save||save;var self=_instances[this.id],targets=[];return mkr.each(target,function(el){TweenMax.set(el,options),parent&&parent.appendChild(el),save||self.save(el,options),targets.push(el)}),targets},mkr.prototype.remove=function(target,killTweens,removeFromDOM){killTweens=mkr.default(killTweens,!0),removeFromDOM=void 0===removeFromDOM||removeFromDOM;var self=_instances[this.id],targets=[];return mkr.each(target,function(el){var n=self._elements.indexOf(el);if(n>-1){self._elements.splice(n,1);var mkrindex=el.getAttribute(self._tag);delete self._states[mkrindex],el.removeAttribute(self._tag),killTweens&&TweenMax.killTweensOf(el),removeFromDOM&&mkr.removeChild(el),targets.push(el)}}),1==targets.length?targets[0]:targets},mkr.prototype.save=function(target,state){var self=_instances[this.id];mkr.each(target,function(el){var mkrindex=el.hasAttribute(self._tag)?el.getAttribute(self._tag):-1;mkrindex==-1&&(el.setAttribute(self._tag,self._count),mkrindex=self._count,self._elements.push(el),self._count++),self._states[mkrindex]=state})},mkr.prototype.kill=function(){TweenMax.killTweensOf(this),TweenMax.killTweensOf(this.container),TweenMax.killChildTweensOf(this.container),mkr.off(".mkr-"+this.id+" *"),mkr.removeChild(this.container)},mkr.prototype.reset=function(killTweens){var len=this._elements.length;killTweens=void 0===killTweens||killTweens;for(var i=0;i<len;i++){var el=this._elements[i],mkrindex=el.getAttribute(this._tag);this._states[mkrindex]&&(killTweens&&TweenMax.killTweensOf(el),TweenMax.to(el,0,{clearProps:"all"}),TweenMax.set(el,this._states[mkrindex]))}},mkr.each=function(target,callback,context){if(null!=target&&"undefined"!=typeof target){var targets;targets="string"==typeof target?mkr.queryAll(target):Array.isArray(target)?target:[target],targets.forEach(callback,context)}},mkr.on=function(target,type,callback,context,priority){mkr.each(target,function(el){var cxt=mkr.default(context,el);mkr._triggerMatrix.add(el,type,callback,cxt,priority)})},mkr.once=function(target,type,callback,context,priority){mkr.each(target,function(el){var cxt=mkr.default(context,el);mkr._triggerMatrix.addOnce(el,type,callback,cxt,priority)})},mkr.off=function(target,type,callback,context){var func;func=void 0===type?mkr._triggerMatrix.delete.bind(mkr._triggerMatrix):void 0===callback?mkr._triggerMatrix.removeAll.bind(mkr._triggerMatrix):mkr._triggerMatrix.remove.bind(mkr._triggerMatrix),mkr.each(target,function(el){var cxt=mkr.default(context,el);func(el,type,callback,cxt)})},mkr.clearListeners=function(){mkr._triggerMatrix.clear()},mkr.reveal=function(target,options,parentOpts){options&&TweenMax.set(target,options),parentOpts=parentOpts||{},mkr.setDefault(parentOpts,"overflowY","visible"),mkr.each(target,function(el){for(var parent=el.parentNode;parent;)parentOpts.height=parent.scrollHeight+1,TweenMax.set(parent,parentOpts),parent=parent.parentNode})},mkr.scroll=function(target,speed,options){options=options||{},mkr.setDefault(options,"scrollTo","max"),mkr.setDefault(options,"ease",Power0.easeNone),speed=mkr.default(speed,14);var tweens=[];return mkr.each(target,function(el){var scrollTime=el.scrollHeight/speed;tweens.push(TweenMax.to(el,scrollTime,options))}),tweens},mkr.extend=function(baseObj){"function"!=typeof Object.create&&(Object.create=function(o){function F(){}return F.prototype=o,new F}),newObj=Object.create(baseObj)},mkr.query=function(selectors,baseElement){return baseElement=baseElement||document,baseElement.querySelector(selectors)},mkr.queryAll=function(selectors,baseElement){return baseElement=baseElement||document,baseElement.querySelectorAll(selectors)},mkr.addChild=function(target,parent,index){return parent=mkr.default(parent,document.body),index=mkr.default(index,parent.childNodes.length-1),parent.insertBefore(target,parent.childNodes[index])},mkr.removeChild=function(target){return target.parentNode.removeChild(target)},mkr.default=function(value,fallback){return void 0===value?fallback:value},mkr.getDefault=function(target,key,value){return mkr.default(target[key],value)},mkr.setDefault=function(target,key,value){return target[key]=mkr.default(target[key],value),target[key]};var createStyleSheet=function(){var style=document.createElement("style");return style.appendChild(document.createTextNode("")),document.head.appendChild(style),style.sheet};return mkr.addRule=function(selector,styles,index){index=void 0===index?mkr.styles.cssRules.length:index;var rules=selector+"{}",n=-1;try{n=mkr.styles.insertRule(rules,index);var rule=mkr.styles.cssRules[n].style;TweenMax.set(rule,{cssRule:styles})}catch(e){console.warn(e)}return n},mkr.removeRule=function(selector){var index=mkr.findRule(selector);index>-1&&mkr.styles.deleteRule(index)},mkr.deleteRule=function(index){mkr.styles.deleteRule(index)},mkr.findRule=function(selector){for(var len=mkr.styles.cssRules.length,i=0;i<len;i++)if(selector===mkr.styles.cssRules[i].selectorText)return i;return-1},mkr.getRule=function(selector){return CSSRulePlugin.getRule(selector)},mkr.setRule=function(selector,styles,index){var rule=CSSRulePlugin.getRule(selector);rule&&TweenMax.set(rule,{cssRule:styles})},mkr.setPolyClipPath=function(target,points,unit){if(!([null,void 0].indexOf(target)<0||[null,void 0].indexOf(points)<0)){unit=void 0===unit?"%":unit;for(var clipPath="polygon(",len=points.length,i=0;i<len;i++)clipPath+=points[i]+unit,i<len-1&&(clipPath+=i%2==0?" ":",");clipPath+=")",TweenMax.set(target,{clipPath:clipPath})}},mkr.distance=function(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))},mkr.rotation=function(x1,y1,x2,y2){var dx=x2-x1,dy=y2-y1;return Math.atan2(dy,dx)},mkr.angle=function(x1,y1,x2,y2){var ang=mkr.rotation(x1,y1,x2,y2)*mkr.DEG;return ang},mkr.randomRange=function(min,max){return Math.floor(Math.random()*(max-min+.99))+min},mkr.RAD=Math.PI/180,mkr.DEG=180/Math.PI,mkr.styles=createStyleSheet(),Object.defineProperty(mkr,"rules",{get:function(){return mkr.styles.cssRules}}),function(className,scope){var SignalManager=function(options){var _signals={};this.register=function(signalId){signalId in _signals||(_signals[signalId]=new signals.Signal)},this.add=function(signalId,listener,context,priority,isOnce){signalId in _signals||(_signals[signalId]=new signals.Signal);var signal=_signals[signalId];return context=context||null,priority=priority||0,isOnce=void 0===isOnce,signal.add(listener,context,priority)},this.addOnce=function(signalId,listener,context,priority){signalId in _signals||(_signals[signalId]=new signals.Signal);var signal=_signals[signalId];return context=context||null,priority=priority||0,signal.addOnce(listener,context,priority)},this.dispatch=function(signalId,params){signalId in _signals&&_signals[signalId].dispatch.apply(null,Array.prototype.slice.call(arguments,1))},this.dispose=function(signalId){signalId in _signals&&(_signals[signalId].dispose(),delete _signals[signalId])},this.forget=function(signalId){signalId in _signals&&_signals[signalId].forget()},this.getNumListeners=function(signalId){return signalId in _signals?_signals[signalId].getNumListeners():0},this.halt=function(signalId){signalId in _signals&&_signals[signalId].halt()},this.has=function(signalId,listener,context){return signalId in _signals&&(context=context||null,_signals[signalId].has(listener,context))},this.remove=function(signalId,listener,context){signalId in _signals&&(context=context||null,_signals[signalId].remove(listener,context))},this.removeAll=function(signalId){signalId in _signals&&_signals[signalId].removeAll()},this.destroy=function(signalId){for(sigId in _signals)_signals[sigId].dispose(),delete _signals[sigId]}};return scope[className]=SignalManager,SignalManager}("SignalManager",mkr),function(className,scope){var matrix=function(options){this._mngrs=new Map,this.add=function(target,type,listener,context,priority,isOnce){isOnce=void 0!==isOnce&&isOnce,this._mngrs.has(target)||this._mngrs.set(target,{signals:new scope.SignalManager,triggers:{}});var trigger,mngr=this._mngrs.get(target);mngr.triggers.hasOwnProperty(type)&&(trigger=mngr.triggers[type],target.removeEventListener(type,trigger),delete mngr.triggers[type]),isOnce?(trigger=function(e){mngr.signals.dispatch(type,e),0==mngr.signals.getNumListeners(type)&&(target.removeEventListener(type,trigger),delete mngr.triggers[type])},mngr.signals.addOnce(type,listener,context,priority)):(trigger=function(e){mngr.signals.dispatch(type,e)},mngr.signals.add(type,listener,context,priority)),target.addEventListener(type,trigger),mngr.triggers[type]=trigger},this.addOnce=function(target,type,listener,context,priority){this.add(target,type,listener,context,priority,!0)},this.remove=function(target,type,listener,context){if(this._mngrs.has(target)){var mngr=this._mngrs.get(target);if(mngr.triggers.hasOwnProperty(type)&&mngr.signals.has(type,listener,context)&&(mngr.signals.remove(type,listener,context),0==mngr.signals.getNumListeners(type))){var trigger=mngr.triggers[type];target.removeEventListener(type,trigger),delete mngr.triggers[type]}}},this.removeAll=function(target,type){if(this._mngrs.has(target)){var mngr=this._mngrs.get(target);if(mngr.triggers.hasOwnProperty(type)){mngr.signals.removeAll(type);var trigger=mngr.triggers[type];target.removeEventListener(type,trigger),delete mngr.triggers[type]}}},this.delete=function(target){if(this._mngrs.has(target)){var mngr=this._mngrs.get(target);for(var type in mngr.triggers){var trigger=mngr.triggers[type];target.removeEventListener(type,trigger),delete mngr.triggers[type]}mngr.signals.destroy(),this._mngrs.delete(target)}},this.clear=function(){var self=this;this._mngrs.forEach(function(mngr,target){self.delete(target)})}};return scope[className]=matrix,matrix}("TriggerMatrix",mkr),mkr._triggerMatrix=new mkr.TriggerMatrix,mkr.VERSION="0.1.2",scope[className]=mkr,mkr}("mkr",window),/*!JS Signals <http://millermedeiros.github.com/js-signals/> @license Released under the MIT license Author: Miller MedeirosVersion: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)*/
function(i){function h(a,b,c,d,e){this._listener=b,this._isOnce=c,this.context=d,this._signal=a,this._priority=e||0}function g(a,b){if("function"!=typeof a)throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b))}function e(){this._bindings=[],this._prevParams=null;var a=this;this.dispatch=function(){e.prototype.dispatch.apply(a,arguments)}}h.prototype={active:!0,params:null,execute:function(a){var b;return this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,a),this._isOnce&&this.detach()),b},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},e.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,d){var e=this._indexOfListener(a,c);if(e!==-1){if(a=this._bindings[e],a.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(b?"Once":"")+"() the same listener without removing the relationship first.")}else a=new h(this,a,b,c,d),this._addBinding(a);return this.memorize&&this._prevParams&&a.execute(this._prevParams),a},_addBinding:function(a){var b=this._bindings.length;do--b;while(this._bindings[b]&&a._priority<=this._bindings[b]._priority);this._bindings.splice(b+1,0,a)},_indexOfListener:function(a,b){for(var d,c=this._bindings.length;c--;)if(d=this._bindings[c],d._listener===a&&d.context===b)return c;return-1},has:function(a,b){return this._indexOfListener(a,b)!==-1},add:function(a,b,c){return g(a,"add"),this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){return g(a,"addOnce"),this._registerListener(a,!0,b,c)},remove:function(a,b){g(a,"remove");var c=this._indexOfListener(a,b);return c!==-1&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)),a},removeAll:function(){for(var a=this._bindings.length;a--;)this._bindings[a]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var d,b=Array.prototype.slice.call(arguments),c=this._bindings.length;if(this.memorize&&(this._prevParams=b),c){d=this._bindings.slice(),this._shouldPropagate=!0;do c--;while(d[c]&&this._shouldPropagate&&d[c].execute(b)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var f=e;f.Signal=e,"function"==typeof define&&define.amd?define(function(){return f}):"undefined"!=typeof module&&module.exports?module.exports=f:i.signals=f}(this);